@model RentCar.WebClient.Models.Cars.CarsViewModel
@{
    ViewData["Title"] = "Available Cars";
}





<link rel="stylesheet" href="~/css/cars.css" />



<div class="cars-container">
    <h1 class="page-title">Sewa Mobil</h1>

    <!-- Sorting Options -->
    <div class="controls-bar">
        <div class="sorting-controls">
            <div class="sort-dropdown">
                <button class="sort-button" onclick="toggleDropdown()">
                    Sort By: @Model.SortBy ▼
                </button>
                <div class="dropdown-menu" id="sortDropdown">
                    <a href="@Url.Action("Index", new { sortBy = "Name", sortOrder = Model.SortOrder, page = 1 })">Name</a>
                    <a href="@Url.Action("Index", new { sortBy = "Model", sortOrder = Model.SortOrder, page = 1 })">Model</a>
                    <a href="@Url.Action("Index", new { sortBy = "Year", sortOrder = Model.SortOrder, page = 1 })">Year</a>
                    <a href="@Url.Action("Index", new { sortBy = "Price", sortOrder = Model.SortOrder, page = 1 })">Price</a>
                </div>
            </div>

            <a href="@Url.Action("Index", new { sortBy = Model.SortBy, sortOrder = Model.SortOrder == "asc" ? "desc" : "asc", page = Model.CurrentPage })"
               class="sort-order-button">
                @if (Model.SortOrder == "asc")
                {
                    <span>↑ Ascending</span>
                }
                else
                {
                    <span>↓ Descending</span>
                }
            </a>
        </div>
        <div class="results-info">
            <p>Showing @((Model.CurrentPage - 1) * 3 + 1) - @Math.Min(Model.CurrentPage * 3, Model.TotalCars) of @Model.TotalCars cars</p>
        </div>
    </div>

    <!-- Car Cards Grid -->
    <div class="cars-grid">
        @foreach (var car in Model.Cars)
        {
            <a href="@Url.Action("Details", "Cars", new { id = car.Car_id })" class="car-card-link">
                <div class="car-card">
                    <div class="car-image">
                        @if (car.CarImages != null && car.CarImages.Any())
                        {
                            <img src="@car.CarImages.First().Image_link" alt="@car.Name">
                        }
                        else
                        {
                            <img src="/images/placeholder-car.jpg" alt="No image">
                        }
                    </div>
                    <div class="car-info">
                        <h3 class="car-name">@car.Name @car.Year</h3>
                        <div class="car-price">
                            <span class="price-label">Harga</span>
                            <span class="price-amount">Rp. @car.Price_per_day.ToString("N0") / hari</span>
                        </div>
                        <div class="details-button">Lihat Selengkapnya</div>
                    </div>
                </div>
            </a>
        }
    </div>

    @if (Model.TotalCars == 0)
    {
        <div class="no-results">
            <p>No available cars at the moment. Please check back later.</p>
        </div>
    }

    <!-- Pagination -->
    @if (Model.TotalPages > 1)
    {
        <nav class="pagination">
            <a href="@Url.Action("Index", new { page = Model.CurrentPage - 1, sortBy = Model.SortBy, sortOrder = Model.SortOrder })"
               class="page-link @(!Model.HasPreviousPage ? "disabled" : "")">
                Previous
            </a>

            @for (int i = 1; i <= Model.TotalPages; i++)
            {
                <a href="@Url.Action("Index", new { page = i, sortBy = Model.SortBy, sortOrder = Model.SortOrder })"
                   class="page-link @(i == Model.CurrentPage ? "active" : "")">
                    @i
                </a>
            }

            <a href="@Url.Action("Index", new { page = Model.CurrentPage + 1, sortBy = Model.SortBy, sortOrder = Model.SortOrder })"
               class="page-link @(!Model.HasNextPage ? "disabled" : "")">
                Next
            </a>
        </nav>
    }
</div>

<script>
    function toggleDropdown() {
        document.getElementById('sortDropdown').classList.toggle('show');
    }

    window.onclick = function(event) {
        if (!event.target.matches('.sort-button')) {
            var dropdowns = document.getElementsByClassName('dropdown-menu');
            for (var i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }
</script>

